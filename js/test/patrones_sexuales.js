var QUESTIONS = [
  {
    question:
      "¿La atracción sexual por personas mutiladas o paralíticas se denomina?",
    answers: ["Abasiofilia", "Actirastia", "Parafilia", "Agonofilia"],
    correctAnswer: "Abasiofilia",
    text: "Según cuentan algunos expertos, en lugares donde la polio (causante de atrofia muscular) causó estragos a mediados de siglo, los estudios indican que hay preponderancia de personas con esta parafilia, en especial los adolescentes.",
    image:
      "https://images.unsplash.com/photo-1515128788771-6db2707998bd?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80",
  },
  {
    question:
      "¿La coprofilia es la práctica que busca la excitación a través de la introducción de sustancias en el recto (por ejemplo un enema)durante juegos sexuales?",
    answers: ["Verdadero", "Falso"],
    correctAnswer: "Falso",
    text: "La coprofilia es la excitación sexual producida al ver defecar,ingerir o manipular heces.",
    image:
      "https://images.unsplash.com/photo-1583141880926-55e0a8efeff3?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1470&q=80",
  },
  {
    question:
      "¿La acción de experimentar placer sexual al tocar, sentir o rozar contra la piel los objetos ajenos como ropa, cabellos, o la piel de otra persona se llama?",
    answers: ["Hierofilia", "Hifefilia", "Homofilia", "Anaclitismo"],
    correctAnswer: "Hifefilia",
    text: "Habitualmente, se trata de objetos utilizados en las principales zonas eróticas del cuerpo de la pareja, como la ropa íntima.",

    image:
      "https://images.unsplash.com/photo-1592398296807-ffa67a54ff82?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80",
  },
  {
    question:
      "¿La kleptofilia es la parafilia de quien siente placer al oler el incienso que se suele utilizar en las misas?",
    answers: ["Verdadero", "Falso"],
    correctAnswer: "Falso",
    text: "La kleptofilia es el hecho de tener que robar para lograr la respuesta erótica. La excitación se obtiene del hecho de entrar y robar la morada de un desconocido o una pareja potencial.",
    image:
      "https://images.unsplash.com/photo-1612216747481-eeac369299c0?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80",
  },
  {
    question: "¿Qué es el voyeurismo?",
    answers: [
      "Buscar placer sexual en la observación de otras personas en situaciones eróticas.",
      "Atracción por ver orinar o ingerir orina",
      "Atracción producida por el sentimiento de envidia",
      "Introducción de objetos en la uretra",
    ],
    correctAnswer:
      "Buscar placer sexual en la observación de otras personas en situaciones eróticas.",
    text: "Puede excitar mucho al voyeurista la posibilidad de ser descubierto. Algunas personas lo llevan hasta sus límites y se arriesgan a ser descubiertas porque de esa manera su excitación se incrementa.",
    image:
      "https://images.unsplash.com/photo-1522264334183-dc22c2332a2a?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80",
  },
  {
    question:
      "¿La transvestofilia es la estimulación sexual por vestir prendas, especialmente prendas interiores, del otro sexo?",
    answers: ["Verdadero", "Falso"],
    correctAnswer: "Verdadero",
    text: "La transvestofilia es el interés sexual por los travestis, es decir, por las personas que se visten con ropas asociadas al sexo opuesto (usualmente hombres vestidos como mujeres).",
    image:
      "https://images.unsplash.com/photo-1514480657081-a987d9a45e90?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80",
  },
  {
    question:
      "¿Atracción por acariciar y realizar sexo oral con una persona dormida hasta despertarla, sin utilizar la violencia se llama?",
    answers: ["Sinforofilia", "Salirofilia", "Ripofilia", "Somnofilia"],
    correctAnswer: "Somnofilia",
    text: "La somnofilia se caracteriza porque la excitación sexual y el orgasmo se obtienen al interactuar sexualmente con una persona que se encuentra durmiendo.",
    image:
      "https://img.playbuzz.com/image/upload/ar_1.5,c_crop/q_auto:good,f_auto,fl_lossy,w_640,c_limit,dpr_1/v1542125154/fdeitudu4ymowvnaazb2.jpg",
  },
  {
    question:
      "¿El pigmalionismo y la agalmatofilia refieren dos prácticas sexuales relacionadas a la excitación producida por el frío o al ver personas con frío?",
    answers: ["Verdadero", "Falso"],
    correctAnswer: "Falso",
    text: "También llamada galateísmo o monumentofilia, refiere a la atracción sexual por estatuas o maniquíes desnudos. Proviene de Pigmalión, personaje mitológico griego que se enamoró de una estatua de su propia creación.",
    image:
      "https://images.unsplash.com/photo-1592399668789-6432393d5761?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80",
  },
  {
    question:
      "¿La atracción por realizar el acto sexual con un cadáver femenino se denomina?",
    answers: ["Negrofilia", "Necrofilia", "Necroclesis", "Nictofilia"],
    correctAnswer: "Necroclesis",
    text: "El individuo solo experimenta placer sexual por los cadáveres femeninos. No sentirá placer alguno por uno masculino.",
    image:
      "https://images.unsplash.com/photo-1618022325802-7e5e732d97a1?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=448&q=80",
  },
  {
    question:
      "¿Existen las personas que sienten excitación proveniente de saber que su pareja padece una enfermedad terminal?",
    answers: ["Verdadero", "Falso"],
    correctAnswer: "Verdadero",
    text: "La nosolagnia solo se experimentará cuando el individuo sea consciente de que su pareja morirá de una enfermedad terminal, hasta entonces sus encuentros sexuales serán casuales en lugar de extremadamente intensos.",
    image:
      "https://images.unsplash.com/photo-1551382331-2109163a9734?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=387&q=80",
  },
];

var correctAnswerElement;
var questionIndex = 0;
var timeLeft = 15;
var timer;
var correct = 0;
var incorrect = 0;

$(function () {
  // Function gets Questions-Data and append it to HTML and
  // returns element containing correct answer
  function getTrivia() {
    var correctAnswer;
    $("#answers").empty();
    $("#question-header").text(QUESTIONS[questionIndex].question);
    QUESTIONS[questionIndex].answers.forEach(function (answer) {
      var div = $("<div>").append(answer);
      div.appendTo($("#answers"));
      if (div.text() === QUESTIONS[questionIndex].correctAnswer) {
        correctAnswer = div;
      }
      div.addClass("hover");
      $("#Titles").css("font-size", "medium"); // Adds hover effect to each answer element
    });

    return correctAnswer;
  }

  // Function adds click event to each answer element and
  // checks for correct answer. If clicked element has
  // correct answer, text turns green and appends check mark
  // else text turns color gray and appends an X mark
  function checkCorrectAnswer() {
    $("#answers")
      .children()
      .click(function () {
        if ($(this).text() === correctAnswerElement.text()) {
          resetIntervalTimer();
          correct++;
          showCorrectAnswer();
        } else {
          resetIntervalTimer();
          Swal.fire({
            icon: "error",
            title: "Respuesta Incorrecta",
            html: "<small><p>" + QUESTIONS[questionIndex].text + "<p></strong>",
            footer:
              '<strong>Respuesta correcta:<p style="color:mediumseagreen;justify-content: center;">' +
              QUESTIONS[questionIndex].correctAnswer +
              "<p> </strong>",
          }).then(function () {
            incorrect++;

            $(this).addClass("wrong");
            $(this).append("<span> &#10008;</span>");
            $(this).siblings().not(correctAnswerElement).addClass("wrong");

            correctAnswerElement.append("<span> &#10004;</span>");
            correctAnswerElement.addClass("correct");

            $("#message").css("display", "block");
            $("#message").css("background", "red");
            $("#timeLeft").css("display", "none");
            $("#message").text("INCORRECTO");

            // $("#imageTrivia").attr("src", "https://images.angelpub.com/2016/35/39703/wrong.gif");
          });
        }

        $(this).parent().children().off("click"); // Prevent click event
        $("#answers").children().removeClass("hover"); // Turn off hover effect
      });
  }

  // Function shows the correct trivia answer
  function showCorrectAnswer() {
    // $("#answers").children().not(correctAnswerElement).addClass("wrong");
    // correctAnswerElement.append("<span> &#10004;</span>");
    // correctAnswerElement.addClass("correct");

    // $("#answers").children().removeClass("hover");
    // $("#answers").children().off("click");

    // $("#message").css("display", "block");
    // $("#timer").css("display", "block");
    // $("#message").text("CORRECTO");

    // $("#imageTrivia").attr("src", "https://c.tenor.com/BntXpMlrGuEAAAAC/check-correct.gif");
    Swal.fire({
      icon: "success",
      title: "Correcto",
      showConfirmButton: false,
      timer: 1600,
    });
  }

  // Function creates a countdown which is display on HTML
  // If timeLeft variable reach zero, correct answer shows up
  // and then wait for 4 seconds to restart
  function intervalTimer() {
    timer = setInterval(function () {
      if (timeLeft == 0) {
        incorrect++;
        showCorrectAnswer();
        clearInterval(timer);

        $("#timer").css("display", "none");
        $("#message").text("se acabó el tiempo!");
        $("#message").css("display", "block");

        setTimeout(function () {
          questionIndex++;
          startGame();
          $("#message").css("display", "none");
          $("#timeLeft").css("display", "block");
          $("#timerSeconds").text(timeLeft);
          $("#imageTrivia").attr("src", QUESTIONS[questionIndex].image);
        }, 5000);
      }
    }, 1000);
  }

  // Function clears countdown after an answer is click and
  // waits four seconds to restart
  function resetIntervalTimer() {
    clearInterval(timer);

    setTimeout(function () {
      questionIndex++;

      startGame();
      $("#message").css("display", "none");
      $("#timer").css("display", "block");
      $("#timeLeft").css("display", "block");

      $("#imageTrivia").attr("src", QUESTIONS[questionIndex].image);
    }, 2000);
  }

  function resetInervalfalse() {
    questionIndex++;

    startGame();
    $("#message").css("display", "none");

    $("#timeLeft").css("display", "block");

    $("#imageTrivia").attr("src", QUESTIONS[questionIndex].image);
  }

  // Function starts the game
  // If questionIndex reach QUESTIONS length, game ends and score
  // shows up, otherwise the games keeps running until last question
  function startGame() {
    if (questionIndex < QUESTIONS.length) {
      correctAnswerElement = getTrivia();

      checkCorrectAnswer();

      intervalTimer();
    } else {
      questionIndex = 0;
      $("#card").css("display", "none");
      $("#correct").text("Correcto: " + correct);
      $("#incorrect").text("Incorrecto: " + incorrect);
      $("#score").css("display", "block");
      var user = firebase.auth().currentUser;
      auth.onAuthStateChanged((user) => {
        var hoy = new Date();
        var dd = hoy.getDate();
        var mm = hoy.getMonth() + 1;
        var yyyy = hoy.getFullYear();
        var data_carpet = dd + "_" + mm + "_" + yyyy;

        var firebaseref = firebase
          .database()
          .ref(
            "Test/" +
              document.getElementById("Titles").innerText +
              "/" +
              data_carpet +
              "/" +
              user.displayName
          );
        const fs = firebase.firestore();

        firebaseref.push({
          // fecha:dd+'/'+mm+'/'+yyyy,
          usuario: user.displayName,
          Hora:
            hoy.getHours() + ":" + hoy.getMinutes() + ":" + hoy.getSeconds(),
          Correctas: correct,
          incorrectas: incorrect,
        });
      });
    }
  }

  // Click event button starts game
  $("#button").click(function () {
    correct = 0;
    incorrect = 0;
    questionIndex = 0;
    $("#card").css("display", "flex");
    $("#button").css("display", "none");
    startGame();
  });

  // Click event close score pop-up
  $("#close").click(function () {
    $("#score").css("display", "none");
    $("#button").css("display", "inline-block");
  });
});

("use strict");
class Circle {
  constructor(x, y, r, c, v, e) {
    this.x = x;
    this.y = y;
    this.r = r;
    this.c = c;
    this.v = v;
    this.e = e;
    this.a = 0.2;
  }
  draw() {
    this.sn += 0.3;
    this.y -= this.v;
    this.y < this.e ? (this.a -= 0.02) : "";
    san.beginPath();
    san.arc(this.x, this.y, this.r, 0, 44 / 7, false);
    san.fillStyle = `rgb(0,0,240)`;
    san.fill();
    san.closePath();
  }
  static push(n) {
    var rad = Mnx(1, 5),
      cx = Mnx(rad, W - rad),
      cy = n ? Mnx(H + rad, H + rad + 100) : Mnx(H * 1.2, H * 0.3),
      cl = Mnx(100, 250),
      vl = Mnx(0.5, 2),
      en = Mnx(H * 0.8, H * 0.25);
    return new Circle(cx, cy, rad, cl, vl, en);
  }
}
var Mnx = (n, x) => {
    return Math.random() * (x - n) + n;
  },
  W = window.innerWidth,
  H = window.innerHeight,
  san;
var ar = [];
for (var i = 0; i < 550; i++) {
  ar.push(Circle.push(false));
}

var draw = () => {
  for (var i = 0; i < ar.length; i++) {
    ar[i].draw();
    if (ar[i].a < 0) {
      ar[i] = Circle.push(true);
    }
  }
};
var init = () => {
  var can = document.querySelector("canvas");
  can.width = W;
  can.height = H;
  can.style.background = "white";
  can.style.position = "fixed";
  can.style.left = 0;
  can.style.top = 0;
  window.backdropFilter = "blur(2px)";
  san = can.getContext("2d");
  var up = () => {
    //san.fillStyle=`rgba(0,0,0,.1)`
    san.clearRect(0, 0, W, H);
    draw();
    webkitRequestAnimationFrame(up);
  };
  webkitRequestAnimationFrame(up);
};
onload = init;
